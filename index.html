<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <title>GifTastic!</title>
</head>

<body>
    <h1>The Ronald Ulysses Swanson Gif Grabber</h1>

    <p>Now with 97% more Ron Swanson! Apologies to the good people at <a href="https://www.nbc.com/parks-and-recreation">NBC</a>.</p>

    <!-- Rendered Buttons get dumped here  -->
    <div id="buttons-view"></div>

    <!-- GIFs go here -->
    <div id="gif-images">
    </div>

    <!-- JavaScript -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
    <script type="text/javascript">

        // Array of Ron-related topics
        var topics = ["America", "Bacon", "Breakfast", "Brunettes", "Drunk Ron Swanson", "Duke Silver", "Eggs", "Fishing", "Guns", "Li'l Sebastian", "Meat", "Ron Swanson", "Scotch", "Steak", "Woodworking"];

        // Function to create buttons for each topic from above
        function renderButtons() {

            // Looping through the array of topics
            for (var i = 0; i < topics.length; i++) {

                // Then dynamicaly generating buttons for each movie in the array with jQuery
                var a = $("<button>");
                // Adding a class of topic-btn to the button - NECESSARY?
                // a.addClass("topic-btn");
                // Adding a data-attribute
                a.attr("data-name", topics[i]);
                // Providing the initial button text
                a.text(topics[i]);
                // Adding the button to the buttons-view div
                $("#buttons-view").append(a);
            }
        };

        renderButtons();

        // Button-click event listener for all button elements
        //Fn writes relevant GIFs to HTML
        $("button").on("click", function () {

            var topics = $(this).attr("data-name");
            var queryURL = "https://api.giphy.com/v1/gifs/search?q=" + topics + "&api_key=0vvAH89sd0za9eZ8qOpv23HRBi9Y7edf&limit=10&rating=pg";
            
            // ?api_key=0vvAH89sd0za9eZ8qOpv23HRBi9Y7edf&tag=" + topics + "&limit=10&rating";

            // AJAX GET request
            $.ajax({
                url: queryURL,
                method: "GET"
            })

                .then(function (response) {

                // Storing an array of the GIF results in a variable
                var results = response.data;
                console.log(results);

                    // Looping through the 10 GIFs grabbed with AJAX
                    for (var i = 0; i < results.length; i++) {

                        // Creating a div with the class "item"
                        var gifDiv = $("<div class='item'>");

                        // Storing the result item's rating
                        var rating = results[i].rating;

                        // Creating a paragraph tag with the result item's rating
                        var p = $("<p>").text("Rating: " + rating);

                        // Creating an image tag
                        var gifImage = $("<img>");

                        // Giving the image tag a src attribute - fixed height
                        gifImage.attr("src", results[i].images.fixed_height.url);

                        // Appending each p and image to the gifDiv
                        gifDiv.append(p);
                        gifDiv.append(gifImage);

                        // Prepending the gifDiv to the relevant div in the HTML
                        $("#gif-images").prepend(gifDiv);
                    }
                })
            });
    </script>
    
</body>
</html>